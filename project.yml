# Specification for XpringKit's XCode project.
name: XpringKit
options:
  bundleIdPrefix: io.xpring
settings:
  LD_RUNPATH_SEARCH_PATHS: "$(inherited) @executable_path/../Frameworks @loader_path/../Frameworks $(PROJECT_DIR)/Carthage/Build/iOS"
targets:
  XpringKit:
    type: framework
    platform: iOS
    sources: [XpringKit]
    scheme:
      testTargets:
        - XpringKitTests
      gatherCoverageData: true
    preBuildScripts:
      - script: ./scripts/regenerate_protos.sh
        name: Build Protos
    postCompileScripts:
      - script: swiftlint --config .swiftlint.yml
        name: SwiftLint
      - script: carthage copy-frameworks
        name: Carthage Copy Frameworks
        inputFiles:
          - $(SRCROOT)/Carthage/Build/iOS/SwiftProtobuf.framework
          - $(SRCROOT)/Carthage/Build/iOS/SwiftGRPC.framework
        outputFiles:
          - $(BUILT_PRODUCTS_DIR)/$(FRAMEWORKS_FOLDER_PATH)/SwiftProtobuf.framework
          - $(BUILT_PRODUCTS_DIR)/$(FRAMEWORKS_FOLDER_PATH)/SwiftGRPC.framework
    dependencies:
      - carthage: SwiftProtobuf
      - carthage: SwiftGRPC
  XpringKitTests:
    type: bundle.unit-test
    platform: iOS
    sources: [Tests]
    dependencies:
      - target: XpringKit
